function playerChart(a){function b(){var a=0;n.forEach(function(){var f=a,b=n[f].name,q=0===f?"1.8em":"1.3em",d=0===f?n[f].x:240+k.gap+k.width*(f-1)+n[f].x;"Earned Quals"===b?(c.append("text").attr("x",d+12).attr("y",34).text("Earned").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",d+16).attr("y",58).text("Quals").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events",
"none")):"Elims"===b?(c.append("text").attr("x",d+8).attr("y",34).text("Elim").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",d).attr("y",58).text("Points").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none")):"Elim %"===b?(c.append("text").attr("x",d+5).attr("y",35).text("Elim").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events",
"none"),c.append("text").attr("x",d+10).attr("y",60).text("%").attr("font-family","burbank").attr("font-size","1.5em").attr("fill","black").attr("pointer-events","none")):"Placement"===b?(c.append("text").attr("x",d+5).attr("y",34).text("Placement").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",d+15).attr("y",55).text("Points").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events",
"none")):"Placement %"===b?(c.append("text").attr("x",d+5).attr("y",34).text("Placement").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",d+25).attr("y",59).text("%").attr("font-family","burbank").attr("font-size","1.5em").attr("fill","black").attr("pointer-events","none")):(f=0===f?58:44,q=c.append("text").attr("x",d).attr("y",f).text(b).attr("font-family","burbank").attr("font-size",q).attr("fill","black").attr("pointer-events",
"none"),"Rank"===b&&(w=q));a++});t&&t.attr("stroke-width",filters.week&&"rank"===filters.sort?9:0)}function e(){var a=k.height/2;m=c.append("polygon").attr("points","180,"+(a-2)+" 230,"+(a-2)+" 205,4").style("fill","darkgrey").attr("pointer-events","bounding-box").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).attr("stroke-width",5)}).on("mouseout",function(a){d3.select(this).attr("stroke-width",0)}).on("click",function(a){u("up")});h=c.append("polygon").attr("points",
"180,"+(a+5)+" 230,"+(a+5)+" 205,"+2*a).style("fill","darkgrey").attr("pointer-events","bounding-box").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).attr("stroke-width",5)}).on("mouseout",function(a){d3.select(this).attr("stroke-width",0)}).on("click",function(a){u("down")})}function u(a){"down"===a&&(filters.page+=1);"up"===a&&--filters.page;v()}function r(a,b){if(!a)throw"You must sort by something";d3.selectAll("svg").selectAll("rect").each(function(f){f&&
f.code===a&&d3.select(this).transition().duration(100).attr("stroke-width",b)})}function l(a){if(null===a)filters.player="",null!=p&&(p.attr("stroke",0),p=null),showPlayerOnWeekChart("");else{a=d3.select(a);var b=z[a.attr("data")].key;""===filters.player?(filters.player=b,a.attr("stroke-width",7),showPlayerOnWeekChart(b),p=a):(""!=filters.player?(p.attr("stroke-width",0),p=a,filters.player=b,a.attr("stroke-width",7)):(a.attr("stroke-width",7),filters.player="",p=null),showPlayerOnWeekChart(b))}}function y(){var a=
filters.sort,b="rank"!==filters.sort?d3.descending:d3.ascending,c=d3.nest().key(function(a){return a.key}).sortKeys(b).entries(x.dimension().top(Infinity));c.sort(function(c,f){return b(c.values[0].value[a],f.values[0].value[a])});q=function(a,b){var c=b.map(function(a){return a.player}).reduce(function(a,b){a[b]=1;return a},{});return a.filter(function(a){a.color=playerColors[a.key];return 1===c[a.key]})}(c,playerDim.top(Infinity));q.sort(function(c,f){return b(c.values[0].value[a],f.values[0].value[a])});
filters.playerCount=q.length}function v(){function a(a,b,c){if(0==b)return a.key;a=a.values[0].value[n[b].code];return 1!=b?n[b].format(a):""===filters.week?d+c+1:a}var d=20*filters.page,H=20*(filters.page+1),D=q.slice(d,H);z=[];for(var e=0;20>e;e++)z.push(D[e]);c.selectAll("text").remove();b();var g=0;z.forEach(function(b){1===D.length&&0==g&&c.select(".row0").each(function(a){l(this)});if(b){c.selectAll(".row").data(n).enter().append("text").attr("x",function(c,f){if(0===f)return 68;var d=10*(6-
a(b,f,g).toString().length);1===f&&(d-=18);return 240+d+k.gap+10+k.width*(f-1)}).attr("y",A+36*g+21).text(function(c,f){return a(b,f,g)}).attr("fill","black").attr("font-size","1.3em").attr("pointer-events","none").attr("font-weight",function(a){return a.code===filters.sort?1E3:400});var f=c.select(".row"+g),d=F[b.color];filters.region&&("NA East"===filters.region&&(d="#319236"),"NA West"===filters.region&&(d="#9D4DBB"),"Europe"===filters.region&&(d="#4C51F7"),"Oceana"===filters.region&&(d="#DB4441"),
"Brazil"===filters.region&&(d="#3E93BC"),"Asia"===filters.region&&(d="#8B4513"));f.transition().attr("fill",d);c.select(".s"+g).transition().style("fill-opacity",-1!=soloQualifications.indexOf(b.key)?1:0);c.select(".d"+g).transition().style("fill-opacity",-1!=duoQualifications.indexOf(b.key)?1:0)}else c.select(".row"+g).attr("fill","none").attr("stroke-width",0),c.select(".s"+g).style("fill-opacity",0),c.select(".d"+g).style("fill-opacity",0);g++});""===filters.week?(w.text("#").attr("x",240+k.gap+
n[1].x+12).attr("y",59).attr("font-size","2.6em"),t.attr("fill","none").attr("pointer-events","none").attr("stroke-width",0)):(w.text("Rank"),t.attr("fill","lightblue").attr("pointer-events","auto"));C(20,d,H);updateCounts()}function C(a,b,c){function f(a,b){a.style("fill-opacity",b?1:0);a.attr("pointer-events",b?"auto":"none")}q.length<a&&(f(m,!1),f(h,!1));0===filters.page&&f(m,!1);0<filters.page&&f(m,!0);c<q.length&&f(h,!0);c>=q.length&&f(h,!1)}var d=function(a){return a},G=d3.format(","),E=d3.format(",.1%"),
n=[{name:"Players",code:"player",x:12,format:d},{name:"Rank",code:"rank",x:16,format:d},{name:"Payout",code:"payout",x:9,format:G},{name:"Points",code:"points",x:13,format:d},{name:"Wins",code:"wins",x:17,format:d},{name:"Earned Quals",code:"earnedQualifications",x:0,format:d},{name:"Elims",code:"elims",x:15,format:d},{name:"Elim %",code:"elimPercentage",x:16,format:E},{name:"Placement",code:"placementPoints",x:0,format:d},{name:"Placement %",code:"placementPercentage",x:0,format:E}],F={green:"#319236",
purple:"#9D4DBB",blue:"#4C51F7",red:"#DB4441",teal:"#3E93BC",lime:"#3CFF3E",grey:"#B3B3B3",brown:"#8B4513"},k={left:150,top:0,height:69,width:80,gap:5};PlayerTableWidth=240+(k.width*(n.length-1)+4);var x=dc.baseMixin({}),A=k.height+14,t,w,m,h,B=PlayerTableWidth,p,z=[],q;x._mandatoryAttributes(["dimension"]);a=d3.select(a);var D,g=[];for(d=0;20>d;d++)g.push({num:d});var c=a.append("svg").attr("width",B+4).attr("height",1E3);(function(){c.selectAll("rect").data(n).enter().append("rect").attr("x",function(a,
b){return 0==b?0:240+k.gap+k.width*(b-1)}).attr("y",k.top+4).attr("width",function(a,b){return 0==b?240:k.width-k.gap-3}).attr("height",k.height).attr("fill",function(a,b){return 0==b?"none":"lightblue"}).attr("stroke","black").attr("stroke-width",0).attr("data",function(a){return a}).attr("rx",cornerRadius).attr("ry",cornerRadius).on("mouseover",function(a){a.code!==filters.sort&&d3.select(this).transition().duration(100).attr("stroke-width",3)}).on("mouseout",function(a){a.code!==filters.sort&&
d3.select(this).transition().duration(100).attr("stroke-width",0)}).on("click",function(a){if(a.code!==filters.sort){r(filters.sort,0);filters.sort=a.code;d3.select(this).transition().duration(100).attr("stroke-width",0);""!=filters.player?clearPlayer(null):(updateCounts(),filters.page=0,y(),v());a=this.x.baseVal.value;var b=this.y.baseVal.value;console.log(this);D.transition().ease(d3.easeBack).duration(400).attr("x",a).attr("y",b)}}).each(function(a,b){1===b&&(t=d3.select(this))});b();e();r("payout",
9);D=c.append("rect").attr("x",240+k.gap+k.width).attr("y",k.top+4).attr("width",k.width-k.gap-3).attr("height",k.height).attr("fill","none").attr("stroke","black").attr("stroke-width",9).attr("pointer-events","none").attr("rx",cornerRadius).attr("ry",cornerRadius)})(c);(function(){g.forEach(function(a){c.append("rect").attr("data",a.num).attr("x",4).attr("y",A+36*a.num).attr("width",B-4).attr("height",30).attr("fill","none").attr("class","row"+a.num).attr("visible","hidden").attr("stroke","black").attr("stroke-width",
0).attr("rx",cornerRadius).attr("ry",cornerRadius).on("mouseover",function(a){a=d3.select(this);var b=z[a.attr("data")].key;filters.player!==b&&a.attr("stroke-width","3")}).on("mouseout",function(a){a=d3.select(this);var b=z[a.attr("data")].key;filters.player!==b&&a.attr("stroke-width","0")}).on("click",function(a){l(this)});c.append("circle").attr("cx",18).attr("cy",A+36*a.num+14).attr("r",10).attr("fill","gold").attr("fill-opacity",0).classed("s"+a.num,!0);var b=c.append("g").style("fill-opacity",
0).attr("pointer-events","none").classed("d"+a.num,!0);b.append("circle").attr("cx",41).attr("cy",A+36*a.num+11).attr("r",7).attr("fill","gold");b.append("circle").attr("cx",52).attr("cy",A+36*a.num+18).attr("r",7).attr("fill","gold")})})(c);x._doRender=function(){filters.page=0;y();v();return x};x._doRedraw=function(){return x._doRender()};clearPlayer=l;return x};function regionChart(a){function b(a){a?(r=!1,v.transition().duration(80).attr("stroke-width",13).transition().duration(350).attr("stroke-width",0)):(a=e.find(function(a){return a.filter===filters.region}),r?v.transition().ease(d3.easeBack).duration(300).attr("cx",a.x).attr("cy",a.y):(r=!0,v.attr("cx",a.x).attr("cy",a.y),v.transition().duration(100).attr("stroke-width",11)))}var e=[{x:53,y:80,color:"#319236",name:"NA EAST",filter:"NA East",textOffset:33},{x:153,y:80,color:"#9D4DBB",name:"NA WEST",
filter:"NA West",textOffset:35},{x:253,y:80,color:"#4C51F7",name:"EUROPE",filter:"Europe",textOffset:30},{x:53,y:180,color:"#DB4441",name:"OCEANIA",filter:"Oceania",textOffset:34},{x:153,y:180,color:"#3E93BC",name:"BRAZIL",filter:"Brazil",textOffset:26},{x:253,y:180,color:"#8B4513",name:"ASIA",filter:"Asia",textOffset:19}],u=[];a=d3.select(a);var r=!1,l=dc.baseMixin({}),y=a.append("svg").attr("width",310).attr("height",430);y.append("text").attr("x",14).attr("y",20).text("Regions").attr("font-size",
"1.8em").attr("fill","black");e.forEach(function(a){var b=y.append("circle").attr("cx",a.x).attr("cy",a.y).attr("r",45).attr("fill",a.color).attr("stroke","black").attr("stroke-width",0).attr("data",a.filter).on("mouseover",function(a){d3.select(this).attr("data")!==filters.region&&d3.select(this).transition().duration(100).attr("stroke-width",4)}).on("mouseout",function(a){a=d3.select(this);a.attr("data")!=filters.region&&a.transition().duration(100).attr("stroke-width",0)}).on("click",function(a){C(d3.select(this))});
u.push(b);y.append("text").attr("x",a.x-a.textOffset).attr("y",a.y+6).text(a.name).attr("font-size","1.4em").attr("fill","black").attr("pointer-events","none")});var v=y.append("circle").attr("cx",50).attr("cy",80).attr("r",45).attr("fill","none").attr("stroke","black").attr("stroke-width",0).attr("pointer-events","none");var C=function(a){var d=a.attr("data");clearPlayer(null);if(""===filters.region)filters.region=d,l.filter(filters.region),a.transition().duration(100).attr("stroke-width",11),l.redrawGroup(),
updateCounts(),b(!1);else if(filters.region!=d){var e=filters.region;u.forEach(function(a){a=d3.select(a._groups[0][0]);a.attr("data")==e&&(l.filter(e),a.transition().duration(100).attr("stroke-width",0))});filters.region=d;l.filter(filters.region);a.transition().duration(100).attr("stroke-width",0);l.redrawGroup();updateCounts();b(!1)}else filters.region="",l.filter(null),a.transition().duration(100).attr("stroke-width",0),l.redrawGroup(),updateCounts(),b(!0)};return l};function weekChart(a){function b(a){if(a)t=!1,p.transition().duration(100).attr("stroke-width",13).transition().duration(300).attr("stroke-width",0);else{a=w._groups[0][0].x.baseVal.value;var b=w._groups[0][0].y.baseVal.value;t?(p.transition().ease(d3.easeBack).duration(350).attr("x",a).attr("y",b),t=!0):(t=!0,p.attr("x",a).attr("y",b),p.transition().duration(100).attr("stroke-width",11))}}function e(a,b,d,c){return a.append("text").attr("x",b+c.x).attr("y",d+c.y).style("font-family","Helvetica, Arial, sans-serif").attr("font-size",
c.size).attr("fill","black").attr("pointer-events","none").attr("fill-opacity","0.0")}function u(a,b,d,c){a=a.append("g").style("fill-opacity",0).attr("pointer-events","none");1==c%2?a.append("circle").attr("data",c).attr("cx",28).attr("cy",22).attr("r",10).attr("fill","gold").attr("transform","translate("+(b-13)+","+(d-7)+")"):(a.append("circle").attr("data",c).attr("cx",26).attr("cy",20).attr("r",7).attr("fill","gold").attr("transform","translate("+(b-13)+","+(d-7)+")"),a.append("circle").attr("data",
c).attr("cx",36).attr("cy",30).attr("r",7).attr("fill","gold").attr("transform","translate("+(b-13)+","+(d-9)+")"));return a}var r=[{num:1,name:"Week 1",type:"Solo",done:!0},{num:2,name:"Week 2",type:"Duo",done:!0},{num:3,name:"Week 3",type:"Solo",done:!0},{num:4,name:"Week 4",type:"Duo",done:!0},{num:5,name:"Week 5",type:"Solo",done:!0},{num:6,name:"Week 6",type:"Duo",done:!0},{num:7,name:"Week 7",type:"Solo",done:!0},{num:8,name:"Week 8",type:"Duo",done:!0},{num:9,name:"Week 9",type:"Solo",done:!0},
{num:10,name:"Week 10",type:"Duo",done:!1}],l=[],y=[],v={x:25,y:59,size:"2em"},C={x:40,y:24,size:"1.2em"},d={x:9,y:41,size:".9em"},G={x:9,y:55,size:".7em"},E={x:9,y:70,size:".7em"},n={x:9,y:85,size:".7em"},F={x:65,y:41,size:".7em"},k={x:65,y:55,size:".7em"},x={x:65,y:70,size:".7em"},A={x:65,y:85,size:".7em"};a=d3.select(a);var t=!1,w,m=dc.baseMixin({}),h=a.append("svg").attr("width",300).attr("height",575);h.append("text").attr("x",55).attr("y",28).text("Solos").attr("font-size","1.9em").attr("fill",
"black");h.append("text").attr("x",200).attr("y",28).text("Duos").attr("font-size","1.9em").attr("fill","black");var B=0;r.forEach(function(a){var b={},g="Solo"===a.type?10:155,c=105*Math.round((B-1)/2)+40,f="lightblue";a.done||(f="#606060");f=h.append("rect").attr("data",a.num).attr("x",g).attr("y",c).attr("width",135).attr("height",95).attr("fill",f).attr("stroke","black").attr("stroke-width",0).attr("rx",cornerRadius).attr("ry",cornerRadius).on("mouseover",function(a){var b=d3.select(this).attr("data");
"Week "+b!==filters.week&&r.filter(function(a){return a.num==b})[0].done&&d3.select(this).transition().duration(100).attr("stroke-width",4)}).on("mouseout",function(a){a=d3.select(this);"Week "+a.attr("data")!=filters.week&&a.transition().duration(100).attr("stroke-width",0)}).on("click",function(a){z(d3.select(this))});b.rect=f;y.push(u(h,g,c,a.num));a=h.append("text").attr("x",g+v.x).attr("y",c+v.y).text("Week "+(B+1)).attr("font-size",v.size).attr("fill","black").attr("pointer-events","none");
b.label=a;b.placeLabel=e(h,g,c,d);b.moneyLabel=e(h,g,c,G);b.winsLabel=e(h,g,c,k);b.pointsLabel=e(h,g,c,F);b.elimsLabel=e(h,g,c,E);b.elimPercentLabel=e(h,g,c,x);b.placementLabel=e(h,g,c,n);b.placementPercentLabel=e(h,g,c,A);l.push(b);B++});var p=h.append("rect").attr("x",0).attr("y",0).attr("width",135).attr("height",95).attr("fill","none").attr("stroke","black").attr("stroke-width",0).attr("pointer-events","none").attr("rx",cornerRadius).attr("ry",cornerRadius);var z=function(a){var d=a.attr("data");
if(r.filter(function(a){return a.num==d})[0].done){var e="Week "+d;clearPlayer(null);if(""===filters.week)filters.week=e,m.filter(filters.week),a.transition().duration(100).attr("stroke-width",11),m.redrawGroup(),updateCounts(),w=a,b(!1);else if(filters.week!=e){var c=filters.week;l.forEach(function(a){a=d3.select(a.rect._groups[0][0]);"Week "+a.attr("data")==c&&(m.filter(c),a.transition().duration(100).attr("stroke-width",0))});filters.week=e;m.filter(filters.week);a.transition().duration(100).attr("stroke-width",
0);m.redrawGroup();updateCounts();w=a;b(!1)}else filters.week="",m.filter(null),a.transition().duration(100).attr("stroke-width",0),m.redrawGroup(),w=a,b(!0),updateCounts()}};showPlayerOnWeekChart=function(a){var b=""===a,d=facts.all().filter(function(b){return b.player===a}),c=0;r.forEach(function(a){var f=d3.format(",d"),e=d.filter(function(b){return a.name===b.week}),g=0!=e.length&&!b,k=g?C:v,h=g?"1.0":"0.0",m=0!=e.length&&0<e[0].soloQual+e[0].duoQual;y[c].transition().style("fill-opacity",m?1:
0);var r=d3.format(",.1%"),n=m="",u="",p="",q="",t="",w="",x="";g&&(m="# "+e[0].rank,n="$"+f(e[0].payout),u=e[0].wins.toString()+(1===u?" win":" wins"),p=e[0].points+" points",q=e[0].elims.toString()+(1===q?" elim":" elims"),t=r(e[0].elims/e[0].points)+" elim",w=e[0].placementPoints.toString()+" place",x=r(e[0].placementPoints/e[0].points)+" place");f="Solo"===a.type?10:155;e=105*Math.round((c-1)/2)+40;l[c].label.transition().attr("x",f+k.x).attr("y",e+k.y).attr("font-size",k.size);l[c].placeLabel.text(m).transition().attr("fill-opacity",
h);l[c].moneyLabel.text(n).transition().attr("fill-opacity",h);l[c].winsLabel.text(u).transition().attr("fill-opacity",h);l[c].pointsLabel.text(p).transition().attr("fill-opacity",h);l[c].elimsLabel.text(q).transition().attr("fill-opacity",h);l[c].elimPercentLabel.text(t).transition().attr("fill-opacity",h);l[c].placementLabel.text(w).transition().attr("fill-opacity",h);l[c].placementPercentLabel.text(x).transition().attr("fill-opacity",h);c++});updateCounts()};return m};var playerDim,playerStatsGroup,LeftSideWidth=340,PlayerTableWidth=960,playerColors,theWeekChart,facts,selectedPlayerNode,showPlayerOnWeekChart,clearPlayer,soloQualifications=[],duoQualifications=[],cornerRadius=8,titleSvg,green="#319236",purple="#9D4DBB",blue="#4C51F7",red="#DB4441",teal="#3E93BC",lime="#3CFF3E",grey="#B3B3B3",brown="#8B4513",filters={week:"",region:"",search:"",player:"",sort:"payout",page:0,playerCount:0};
d3.json("fwc/data/data.json").then(function(a){var b=LeftSideWidth+PlayerTableWidth-20;titleSvg=title(b);searchLabel(titleSvg);disclaimer(titleSvg);a.forEach(function(a){a.rank=+a.rank;a.payout=+a.payout;a.points=+a.points});makeQualifications(a);facts=crossfilter(a);draw(facts);helpButton(titleSvg,b);filtersAndCount(titleSvg,b);d3.select("#search-input").on("keyup",function(a){filters.player="";showPlayerOnWeekChart();var b=document.getElementById("search-input").value;filters.search=b;playerDim.filter(function(a){return-1!==
a.toLowerCase().indexOf(b.toLowerCase())});dc.redrawAll()});updateCounts()});function makeQualifications(a){a.forEach(function(a){0!=a.soloQual&&soloQualifications.push(a.player);0!=a.duoQual&&duoQualifications.push(a.player)})}function title(a){a=d3.select(".title").append("svg").attr("width",a+"px").attr("height","70px");a.append("text").attr("x",0).attr("y",65).text("FORTNITE  World Cup Stats").attr("font-size","1.1em").attr("fill","black");return a}
function searchLabel(a){a.append("text").attr("x",565).attr("y",64).text("Search").attr("font-size","1.4rem").attr("fill","black").attr("font-weight",400)}function disclaimer(a){a.append("text").attr("x",952).attr("y",30).text("Includes top 100 in each region for each week").attr("font-size",".8rem").attr("fill","#606060").style("font-family","Helvetica, Arial, sans-serif").attr("font-weight",400)}
function filtersAndCount(a,b){a.append("text").attr("x",b-540).attr("y",65).text("").attr("font-size","1.6rem").attr("fill","black").attr("pointer-events","none").attr("id","filterText")}
function helpButton(a,b){a.append("circle").attr("cx",b-30).attr("cy",46).attr("r",22).attr("fill","green").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).transition().duration(50).attr("stroke-width",4)}).on("mouseout",function(a){d3.select(this).transition().duration(50).attr("stroke-width",0)}).on("click",function(a){window.open("help.html","_blank")});a.append("text").attr("x",b-38).attr("y",64).text("?").attr("font-size",".7em").attr("fill","black").attr("pointer-events",
"none")}
function updateCounts(){makePlayerStatsGroup(playerDim);if(""!=filters.player)var a=filters.player;else{a=[];""!=filters.region&&a.push(filters.region);""!=filters.week&&a.push(filters.week);""!=filters.search&&a.push('"'+filters.search+'"');var b=d3.format(",d");a.push(b(filters.playerCount)+" players");a=a.join(" / ");b=filters.sort.charAt(0).toUpperCase()+filters.sort.slice(1);switch(filters.sort){case "earnedQualifications":b="Earned Quals";break;case "elims":b="Elim Points";break;case "elimPercentage":b="Elim %";
break;case "placementPoints":b="Placement Points";break;case "placementPercentage":b="Placement %"}a+=" by "+b}titleSvg.select("#filterText").text(a)}
function draw(a){playerDim=a.dimension(dc.pluck("player"));makePlayerColors();makePlayerStatsGroup(playerDim);var b=a.dimension(dc.pluck("region")),e=b.group().reduceSum(dc.pluck("payout"));a=a.dimension(dc.pluck("week"));var u=a.group().reduceSum(dc.pluck("payout"));weekChart("#chart-weeks").dimension(a).group(u);regionChart("#chart-region").dimension(b).group(e);b=playerChart("#chart-player").dimension(playerStatsGroup);dc.registerChart(b,null);dc.renderAll();updateCounts()}
function makePlayerColors(){playerColors={};playerDim.top(Infinity).forEach(function(a){playerColors[a.player]=getColorForRegion(a.region)})}function getColorForRegion(a){switch(a){case "NA West":return"purple";case "NA East":return"green";case "Europe":return"blue";case "Oceania":return"red";case "Asia":return"brown";case "Brazil":return"teal"}}
function makePlayerStatsGroup(){playerStatsGroup=playerDim.group().reduce(function(a,b){a.soloQual+=b.soloQual;a.duoQual+=b.duoQual;a.rank+=b.rank;a.payout+=b.payout;a.points+=b.points;a.wins+=b.wins;a.elims+=b.elims;a.elimPercentage=a.elims/a.points;a.placementPoints+=b.placementPoints;a.placementPercentage=a.placementPoints/a.points;a.earnedQualifications+=b.earnedQualifications;return a},function(a,b){a.soloQual-=b.soloQual;a.duoQual-=b.duoQual;a.rank-=b.rank;a.payout-=b.payout;a.points-=b.points;
a.wins-=b.wins;a.elims-=b.elims;a.elimPercentage=a.elims/a.points;a.placementPoints-=b.placementPoints;a.placementPercentage=a.placementPoints/a.points;a.earnedQualifications-=b.earnedQualifications;return a},function(a){return{soloQual:0,duoQual:0,rank:0,payout:0,points:0,wins:0,elims:0,elimPercentage:0,placementPoints:0,placementPercentage:0,earnedQualifications:0}})};