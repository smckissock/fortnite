---
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=10, fig.height=6, fig.path='Figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)

# Show a maximum of 100   
options(tibble.print_max = 100, tibble.print_min = 5)

library(tidyverse)

raw_data <- read_csv("C:/project/fortnite/r/player-search/data.csv")
```
### Fortnite Ping Player Searches
***October 27, 2019***

We started tracking player searches on Fortnite Ping in mid October. More than 3,000 players were searched in more than 11,000 searches. Here is the breakdown of searches by region. The relatively large number of searches in NA East may be due to the it being used to organize practice matches.   

```{r region_search_chart, fig.width = 7, fig.height = 2}

regions <- raw_data %>% 
  group_by(Region) %>% 
  summarize(total = sum(TotalEvents))
  
ggplot(regions, aes(x = total, y = reorder(Region, total))) +
  geom_segment(aes(yend = Region), xend = 0, color = "grey50", size = 2) +
  geom_point(size = 4, color = "black") +
  scale_color_brewer(palette = "Set1") +
  theme_bw() + 
  theme(legend.position = "none") + 
  theme(panel.grid.major.y = element_blank()) +
  labs(
    x = "",
    y = ""
  ) 
```


Here is a breakdown of the players who have more than 10 searches. Note that we don't track who was doing the searching, only who was searched!

```{r player_search_chart, fig.width = 8, fig.height = 26}

searches <- raw_data %>% 
  group_by(Name, Region) %>% 
  summarize(total = sum(TotalEvents)) %>%
  group_by(Region) %>%
  filter(total > 10)
  #top_n(2)  -- top n in region

  
ggplot(searches, aes(x = total, y = reorder(Name, total))) +
  geom_segment(aes(yend = Name), xend = 0, color = "grey50", size = 2) +
  geom_point(size = 4, aes(color = Region)) +
  scale_color_brewer(palette = "Set1") +
  theme_bw() + 
  theme(legend.position = "top") + 
  theme(panel.grid.major.y = element_blank()) +
  labs(
    x = "",
    y = ""
  ) +
  facet_grid(Region ~ ., scales = "free_y", space = "free_y")
```