function playerChart(a){function b(){var a=0;t.forEach(function(){var b=a,h=t[b].name,d=0===b?"1.8em":"1.3em",k=0===b?t[b].x:240+n.gap+n.width*(b-1)+t[b].x;"Earned Quals"===h?(c.append("text").attr("x",k+12).attr("y",34).text("Earned").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",k+16).attr("y",58).text("Quals").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events",
"none")):"Elims"===h?(c.append("text").attr("x",k+8).attr("y",34).text("Elim").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",k).attr("y",58).text("Points").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events","none")):"Elim %"===h?(c.append("text").attr("x",k+5).attr("y",35).text("Elim").attr("font-family","burbank").attr("font-size","1.2em").attr("fill","black").attr("pointer-events",
"none"),c.append("text").attr("x",k+10).attr("y",60).text("%").attr("font-family","burbank").attr("font-size","1.5em").attr("fill","black").attr("pointer-events","none")):"Placement"===h?(c.append("text").attr("x",k+5).attr("y",34).text("Placement").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",k+15).attr("y",55).text("Points").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events",
"none")):"Placement %"===h?(c.append("text").attr("x",k+5).attr("y",34).text("Placement").attr("font-family","burbank").attr("font-size","1.0em").attr("fill","black").attr("pointer-events","none"),c.append("text").attr("x",k+25).attr("y",59).text("%").attr("font-family","burbank").attr("font-size","1.5em").attr("fill","black").attr("pointer-events","none")):(b=0===b?58:44,d=c.append("text").attr("x",k).attr("y",b).text(h).attr("font-family","burbank").attr("font-size",d).attr("fill","black").attr("pointer-events",
"none"),"Rank"===h&&(p=d));a++});f&&f.attr("stroke-width",filters.week&&"rank"===filters.sort?9:0)}function e(){var a=n.height/2;w=c.append("polygon").attr("points","180,"+(a-2)+" 230,"+(a-2)+" 205,4").style("fill","darkgrey").attr("pointer-events","bounding-box").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).attr("stroke-width",5)}).on("mouseout",function(a){d3.select(this).attr("stroke-width",0)}).on("click",function(a){l(null);m("up")});x=c.append("polygon").attr("points",
"180,"+(a+5)+" 230,"+(a+5)+" 205,"+2*a).style("fill","darkgrey").attr("pointer-events","bounding-box").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).attr("stroke-width",5)}).on("mouseout",function(a){d3.select(this).attr("stroke-width",0)}).on("click",function(a){l(null);m("down")})}function m(a){"down"===a&&(filters.page+=1);"up"===a&&--filters.page;u()}function r(a,b){if(!a)throw"You must sort by something";d3.selectAll("svg").selectAll("rect").each(function(h){h&&
h.code===a&&d3.select(this).transition().duration(100).attr("stroke-width",b)})}function q(a){if(a)H=!1,d.transition().duration(200).attr("stroke-width",0);else{a=v._groups[0][0].x.baseVal.value;var b=v._groups[0][0].y.baseVal.value;H?d.attr("stroke-width",9).transition().ease(d3.easeBack).duration(300).attr("x",a).attr("y",b):(d.attr("x",a).attr("y",b),d.transition().duration(100).attr("stroke-width",9));H=!0}}function l(a){if(null===a)filters.player="",null!=v&&(v.attr("stroke",0),v=null),showPlayerOnWeekChart(""),
H=!1,q(!0);else{var b=d3.select(a),h=E[b.attr("data")].key;""===filters.player?(filters.player=h,b.attr("stroke-width",7),showPlayerOnWeekChart(h),v=b,H=!1,q(!1),updateCounts()):a!==v.node()?(v.attr("stroke-width",0),v=b,filters.player=h,b.attr("stroke-width",7),showPlayerOnWeekChart(h),q(!1),updateCounts()):(b.attr("stroke-width",0),filters.player="",v=null,q(!0),updateCounts(),showPlayerOnWeekChart(""))}}function y(){var a=filters.sort,b="rank"!==filters.sort?d3.descending:d3.ascending,c=d3.nest().key(function(a){return a.key}).sortKeys(b).entries(B.dimension().top(Infinity));
c.sort(function(h,c){return b(h.values[0].value[a],c.values[0].value[a])});k=function(a,b){var h=b.map(function(a){return a.player}).reduce(function(a,b){a[b]=1;return a},{});return a.filter(function(a){a.color=playerColors[a.key];return 1===h[a.key]})}(c,playerDim.top(Infinity));k.sort(function(h,c){return b(h.values[0].value[a],c.values[0].value[a])});filters.playerCount=k.length}function u(){function a(a,b,h){if(0==b)return a.key;a=a.values[0].value[t[b].code];return 1!=b?t[b].format(a):""===filters.week?
d+h+1:a}var d=20*filters.page,A=20*(filters.page+1),e=k.slice(d,A);E=[];for(var G=0;20>G;G++)E.push(e[G]);c.selectAll("text").each(function(a){"w"!=a&&d3.select(this).remove()});b();var g=0;E.forEach(function(b){1===e.length&&0==g&&c.select(".row0").each(function(a){l(this)});if(b){c.selectAll(".row").data(t).enter().append("text").attr("x",function(h,c){if(0===c)return 68;var k=10*(6-a(b,c,g).toString().length);1===c&&(k-=18);return 240+k+n.gap+10+n.width*(c-1)}).attr("y",C+36*g+21).text(function(h,
c){return a(b,c,g)}).attr("fill","black").attr("font-size","1.3em").attr("pointer-events","none").attr("font-weight",function(a){return a.code===filters.sort?1E3:400});var h=c.select(".row"+g),k=J[b.color];filters.region&&("NA East"===filters.region&&(k="#56af5a"),"NA West"===filters.region&&(k="#ad76c1"),"Europe"===filters.region&&(k="#4C51F7"),"Oceania"===filters.region&&(k="#e25856"),"Brazil"===filters.region&&(k="#3E93BC"),"Asia"===filters.region&&(k="#987654"));h.transition().attr("fill",k);
z(soloQualifications,"s",b.key,g);z(duoQualifications,"d",b.key,g)}else c.select(".row"+g).attr("fill","none").attr("stroke-width",0),c.select(".s"+g).style("fill-opacity",0),c.select(".d"+g).style("fill-opacity",0);g++});""===filters.week?(p.text("#").attr("x",240+n.gap+t[1].x+12).attr("y",59).attr("font-size","2.6em"),f.attr("fill","none").attr("pointer-events","none").attr("stroke-width",0)):(p.text("Rank"),f.attr("fill","lightblue").attr("pointer-events","auto"));D(20,d,A);updateCounts()}function z(a,
b,k,d){a=(a=a.find(function(a){return a.player===k}))?a.week:0;c.select("."+b+d).transition().style("fill-opacity",0==a?0:1);d=c.select("."+b+"week"+d);d.transition().text(0==a?"":a);"d"===b&&d.transition().attr("x","10"==a?40:45)}function D(a,b,c){function h(a,b){a.style("fill-opacity",b?1:0);a.attr("pointer-events",b?"auto":"none")}k.length<a&&(h(w,!1),h(x,!1));0===filters.page&&h(w,!1);0<filters.page&&h(w,!0);c<k.length&&h(x,!0);c>=k.length&&h(x,!1)}var g=function(a){return a},A=d3.format(","),
I=d3.format(",.1%"),t=[{name:"Players",code:"player",x:12,format:g},{name:"Rank",code:"rank",x:16,format:g},{name:"Payout",code:"payout",x:9,format:A},{name:"Points",code:"points",x:13,format:g},{name:"Wins",code:"wins",x:17,format:g},{name:"Earned Quals",code:"earnedQualifications",x:0,format:g},{name:"Elims",code:"elims",x:15,format:g},{name:"Elim %",code:"elimPercentage",x:16,format:I},{name:"Placement",code:"placementPoints",x:0,format:g},{name:"Placement %",code:"placementPercentage",x:0,format:I}],
J={green:"#319236",purple:"#9D4DBB",blue:"#4C51F7",red:"#DB4441",teal:"#3E93BC",lime:"#3CFF3E",grey:"#B3B3B3",brown:"#987654"},n={left:150,top:0,height:69,width:80,gap:5};PlayerTableWidth=240+(n.width*(t.length-1)+4);var B=dc.baseMixin({}),C=n.height+14,f,p,w,x,F=PlayerTableWidth,v,E=[],k;B._mandatoryAttributes(["dimension"]);a=d3.select(a);var G,d,H=!1,K=[];for(g=0;20>g;g++)K.push({num:g});var c=a.append("svg").attr("width",F+4).attr("height",1E3);(function(){c.selectAll("rect").data(t).enter().append("rect").attr("x",
function(a,b){return 0==b?0:240+n.gap+n.width*(b-1)}).attr("y",n.top+4).attr("width",function(a,b){return 0==b?240:n.width-n.gap-3}).attr("height",n.height).attr("fill",function(a,b){return 0==b?"none":"lightblue"}).attr("stroke","black").attr("stroke-width",0).attr("data",function(a){return a}).attr("rx",cornerRadius).attr("ry",cornerRadius).on("mouseover",function(a){a.code!==filters.sort&&d3.select(this).transition().duration(100).attr("stroke-width",3)}).on("mouseout",function(a){a.code!==filters.sort&&
d3.select(this).transition().duration(100).attr("stroke-width",0)}).on("click",function(a){if(a.code!==filters.sort){r(filters.sort,0);filters.sort=a.code;d3.select(this).transition().duration(100).attr("stroke-width",0);""!=filters.player&&l(null);filters.page=0;y();u();a=this.x.baseVal.value;var b=this.y.baseVal.value;G.transition().ease(d3.easeBack).duration(400).attr("x",a).attr("y",b)}}).each(function(a,b){1===b&&(f=d3.select(this))});b();e();r("payout",9);G=c.append("rect").attr("x",240+n.gap+
n.width).attr("y",n.top+4).attr("width",n.width-n.gap-3).attr("height",n.height).attr("fill","none").attr("stroke","black").attr("stroke-width",9).attr("pointer-events","none").attr("rx",cornerRadius).attr("ry",cornerRadius)})(c);(function(){K.forEach(function(a){c.append("rect").attr("data",a.num).attr("x",4).attr("y",C+36*a.num).attr("width",F-4).attr("height",29).attr("fill","none").attr("class","row"+a.num).attr("visible","hidden").attr("stroke","black").attr("stroke-width",0).attr("rx",cornerRadius).attr("ry",
cornerRadius).on("mouseover",function(a){a=d3.select(this);var b=E[a.attr("data")].key;filters.player!==b&&a.attr("stroke-width","3")}).on("mouseout",function(a){a=d3.select(this);var b=E[a.attr("data")].key;filters.player!==b&&a.attr("stroke-width","0")}).on("click",function(a){l(this)});0===a.num&&(d=c.append("rect").attr("x",4).attr("y",n.top+4).attr("width",F-4).attr("height",29).attr("fill","none").attr("stroke","black").attr("stroke-width",0).attr("pointer-events","none").attr("rx",cornerRadius).attr("ry",
cornerRadius));c.append("circle").attr("cx",21).attr("cy",C+36*a.num+14).attr("r",12).attr("fill","#FFAC08").attr("fill-opacity",0).classed("s"+a.num,!0);c.append("text").attr("x",18).attr("y",C+36*a.num+18).text("9").attr("fill","black").attr("font-size","1.0em").attr("pointer-events","none").attr("font-weight",400).classed("sweek"+a.num,!0).data("w");var b=c.append("g").style("fill-opacity",0).attr("pointer-events","none").classed("d"+a.num,!0);b.append("circle").attr("cx",44).attr("cy",C+36*a.num+
11).attr("r",9).attr("fill","#FFAC08");b.append("circle").attr("cx",54).attr("cy",C+36*a.num+18).attr("r",9).attr("fill","#FFAC08");b.append("text").attr("x",45).attr("y",C+36*a.num+18).text("1").attr("fill","black").attr("font-size","1.0em").attr("pointer-events","none").attr("font-weight",400).classed("dweek"+a.num,!0).data("w")})})(c);B._doRender=function(){filters.page=0;y();u();return B};B._doRedraw=function(){return B._doRender()};clearPlayer=l;return B};function regionChart(a){function b(a){a?(r=!1,y.transition().duration(80).attr("stroke-width",13).transition().duration(350).attr("stroke-width",0)):(a=e.find(function(a){return a.filter===filters.region}),r?y.transition().ease(d3.easeBack).duration(300).attr("cx",a.x).attr("cy",a.y):(r=!0,y.attr("cx",a.x).attr("cy",a.y),y.transition().duration(100).attr("stroke-width",11)))}var e=[{x:53,y:80,color:"#56af5a",name:"NA EAST",filter:"NA East",textOffset:33},{x:153,y:80,color:"#ad76c1",name:"NA WEST",
filter:"NA West",textOffset:35},{x:253,y:80,color:"#4C51F7",name:"EUROPE",filter:"Europe",textOffset:30},{x:53,y:180,color:"#e25856",name:"OCEANIA",filter:"Oceania",textOffset:34},{x:153,y:180,color:"#3E93BC",name:"BRAZIL",filter:"Brazil",textOffset:26},{x:253,y:180,color:"#987654",name:"ASIA",filter:"Asia",textOffset:19}],m=[];a=d3.select(a);var r=!1,q=dc.baseMixin({}),l=a.append("svg").attr("width",310).attr("height",430);l.append("text").attr("x",14).attr("y",20).text("Regions").attr("font-size",
"1.8em").attr("fill","black");e.forEach(function(a){var b=l.append("circle").attr("cx",a.x).attr("cy",a.y).attr("r",45).attr("fill",a.color).attr("stroke","black").attr("stroke-width",0).attr("data",a.filter).on("mouseover",function(a){d3.select(this).attr("data")!==filters.region&&d3.select(this).transition().duration(100).attr("stroke-width",4)}).on("mouseout",function(a){a=d3.select(this);a.attr("data")!=filters.region&&a.transition().duration(100).attr("stroke-width",0)}).on("click",function(a){u(d3.select(this))});
m.push(b);l.append("text").attr("x",a.x-a.textOffset).attr("y",a.y+6).text(a.name).attr("font-size","1.4em").attr("fill","black").attr("pointer-events","none")});var y=l.append("circle").attr("cx",50).attr("cy",80).attr("r",45).attr("fill","none").attr("stroke","black").attr("stroke-width",0).attr("pointer-events","none");var u=function(a){var e=a.attr("data");clearPlayer(null);if(""===filters.region)filters.region=e,q.filter(filters.region),a.transition().duration(100).attr("stroke-width",11),q.redrawGroup(),
b(!1);else if(filters.region!=e){var g=filters.region;m.forEach(function(a){a=d3.select(a._groups[0][0]);a.attr("data")==g&&(q.filter(g),a.transition().duration(100).attr("stroke-width",0))});filters.region=e;q.filter(filters.region);a.transition().duration(100).attr("stroke-width",0);q.redrawGroup();b(!1)}else filters.region="",q.filter(null),a.transition().duration(100).attr("stroke-width",0),q.redrawGroup(),b(!0)};return q};function weekChart(a){function b(a){var b="Solos"===a.getName();b?x.checked(!1):w.checked(!1);filters.week="";a.checked()?(filters.soloOrDuo=b?"Solos":"Duos",f.filter(null),b?(f.filter("Week 1"),f.filter("Week 3"),f.filter("Week 5"),f.filter("Week 7"),f.filter("Week 9")):(f.filter("Week 2"),f.filter("Week 4"),f.filter("Week 6"),f.filter("Week 8"),f.filter("Week 10"))):filters.soloOrDuo=null;f.redrawGroup();updateCounts();e()}function e(){l.forEach(function(a){var b="Solos"===filters.soloOrDuo,e="Duos"===
filters.soloOrDuo;b=1==a.week.num%2?b?8:0:e?8:0;"Week "+a.week.num===filters.week&&(b=8);l[a.week.num-1].rect.transition().delay(10*a.week.num).duration(300).attr("stroke-width",b)})}function m(a,b,e,d){return a.append("text").attr("x",b+d.x).attr("y",e+d.y).style("font-family","Helvetica, Arial, sans-serif").attr("font-size",d.size).attr("fill","black").attr("pointer-events","none").attr("fill-opacity","0.0")}function r(a,b,e,d){a=a.append("g").style("fill-opacity",0).attr("pointer-events","none");
1==d%2?a.append("circle").attr("data",d).attr("cx",29).attr("cy",23).attr("r",10).attr("fill","gold").attr("fill","#FFAC08").attr("transform","translate("+(b-13)+","+(e-7)+")"):(a.append("circle").attr("data",d).attr("cx",26).attr("cy",20).attr("r",7).attr("fill","#FFAC08").attr("transform","translate("+(b-13)+","+(e-7)+")"),a.append("circle").attr("data",d).attr("cx",36).attr("cy",30).attr("r",7).attr("fill","#FFAC08").attr("transform","translate("+(b-13)+","+(e-9)+")"));return a}var q=[{num:1,name:"Week 1",
type:"Solo",done:!0},{num:2,name:"Week 2",type:"Duo",done:!0},{num:3,name:"Week 3",type:"Solo",done:!0},{num:4,name:"Week 4",type:"Duo",done:!0},{num:5,name:"Week 5",type:"Solo",done:!0},{num:6,name:"Week 6",type:"Duo",done:!0},{num:7,name:"Week 7",type:"Solo",done:!0},{num:8,name:"Week 8",type:"Duo",done:!0},{num:9,name:"Week 9",type:"Solo",done:!0},{num:10,name:"Week 10",type:"Duo",done:!0}],l=[],y=[],u={x:25,y:59,size:"2em"},z={x:32,y:45,size:"1.6em"},D={x:40,y:24,size:"1.2em"},g={x:9,y:41,size:".9em"},
A={x:9,y:55,size:".7em"},I={x:9,y:70,size:".7em"},t={x:9,y:85,size:".7em"},J={x:65,y:41,size:".7em"},n={x:65,y:55,size:".7em"},B={x:65,y:70,size:".7em"},C={x:65,y:85,size:".7em"};a=d3.select(a);var f=dc.baseMixin({}),p=a.append("svg").attr("width",300).attr("height",565);p.append("text").attr("x",25).attr("y",24).text("Solos").attr("font-size","1.9em").attr("fill","black");p.append("text").attr("x",170).attr("y",24).text("Duos").attr("font-size","1.9em").attr("fill","black");var w=new d3CheckBox("Solos");
w.size(27).x(100).y(3).rx(6).ry(6).markStrokeWidth(6).boxStrokeWidth(2).checked(!1).clickEvent(function(){b(w)});p.call(w);var x=new d3CheckBox("Duos");x.size(27).x(255).y(3).rx(6).ry(6).markStrokeWidth(6).boxStrokeWidth(2).checked(!1).clickEvent(function(){b(x)});p.call(x);var F=0;q.forEach(function(a){var b={},e="Solo"===a.type?10:155,d=103*Math.round((F-1)/2)+40,f="lightblue";a.done||(f="#606060");f=p.append("rect").attr("data",a.num).attr("x",e).attr("y",d).attr("width",135).attr("height",93).attr("fill",
f).attr("stroke","black").attr("stroke-width",0).attr("rx",cornerRadius).attr("ry",cornerRadius).on("mouseover",function(a){var b=d3.select(this).attr("data");"Week "+b!==filters.week&&q.filter(function(a){return a.num==b})[0].done&&d3.select(this).transition().duration(100).attr("stroke-width",4)}).on("mouseout",function(a){a=d3.select(this);1===a.attr("data")%2&&"Solos"===filters.soloOrDuo?a.transition().duration(100).attr("stroke-width",8):0===a.attr("data")%2&&"Duos"===filters.soloOrDuo?a.transition().duration(100).attr("stroke-width",
8):"Week "+a.attr("data")!=filters.week&&a.transition().duration(100).attr("stroke-width",0)}).on("click",function(a){v(d3.select(this))});b.rect=f;y.push(r(p,e,d,a.num));f=p.append("text").attr("x",e+u.x).attr("y",d+u.y).text("Week "+(F+1)).attr("font-size",u.size).attr("fill","black").attr("pointer-events","none");var E=p.append("text").attr("x",e+8).attr("y",d+u.y+8).text("Placed outside top 100").attr("font-size",".9em").attr("fill","black").attr("fill-opacity",0).attr("pointer-events","none");
b.week=a;b.label=f;b.noPlaceLabel=E;b.placeLabel=m(p,e,d,g);b.moneyLabel=m(p,e,d,A);b.winsLabel=m(p,e,d,n);b.pointsLabel=m(p,e,d,J);b.elimsLabel=m(p,e,d,I);b.elimPercentLabel=m(p,e,d,B);b.placementLabel=m(p,e,d,t);b.placementPercentLabel=m(p,e,d,C);l.push(b);F++});var v=function(a){var b=a.attr("data");if(q.filter(function(a){return a.num==b})[0].done){filters.soloOrDuo="";filters.soloOrDuo="";w.checked(!1);x.checked(!1);var g="Week "+b;clearPlayer(null);if(""===filters.week)filters.week=g,f.filter(filters.week),
a.transition().duration(100).attr("stroke-width",8);else{if(filters.week!=g){var d=filters.week;l.forEach(function(a){a=d3.select(a.rect._groups[0][0]);"Week "+a.attr("data")==d&&(f.filter(d),a.transition().duration(100).attr("stroke-width",0))});filters.week=g;f.filter(filters.week)}else filters.week="",f.filter(null);a.transition().duration(100).attr("stroke-width",0)}f.redrawGroup();e()}};showPlayerOnWeekChart=function(a){var b=""===a,e=facts.all().filter(function(b){return b.player===a}),d=0;
q.forEach(function(a){var g=d3.format(",d"),c=e.filter(function(b){return a.name===b.week}),h=0!=c.length&&!b,k=h?D:z;b&&(k=u);var f=h?"1.0":"0.0",A="1.0"==f?"0":"1";b&&(A="0");var m=0!=c.length&&0<c[0].soloQual+c[0].duoQual;y[d].transition().style("fill-opacity",m?1:0);var n=d3.format(",.1%"),q=m="",p="",r="",t="",v="",w="",x="";h&&(m="# "+c[0].rank,q="$"+g(c[0].payout),p=c[0].wins.toString()+(1===p?" win":" wins"),r=c[0].points+" points",t=c[0].elims.toString()+(1===t?" elim":" elims"),v=n(c[0].elims/
c[0].points)+" elim",w=c[0].placementPoints.toString()+" place",x=n(c[0].placementPoints/c[0].points)+" place");g="Solo"===a.type?10:155;c=103*Math.round((d-1)/2)+40;l[d].label.transition().attr("x",g+k.x).attr("y",c+k.y).attr("font-size",k.size);l[d].noPlaceLabel.transition().attr("fill-opacity",A);l[d].placeLabel.text(m).transition().attr("fill-opacity",f);l[d].moneyLabel.text(q).transition().attr("fill-opacity",f);l[d].winsLabel.text(p).transition().attr("fill-opacity",f);l[d].pointsLabel.text(r).transition().attr("fill-opacity",
f);l[d].elimsLabel.text(t).transition().attr("fill-opacity",f);l[d].elimPercentLabel.text(v).transition().attr("fill-opacity",f);l[d].placementLabel.text(w).transition().attr("fill-opacity",f);l[d].placementPercentLabel.text(x).transition().attr("fill-opacity",f);d++})};return f}
function d3CheckBox(a){function b(a){a=a.append("g");var b=[{x:m+e/4,y:r+e/2},{x:m+e/2.2,y:r+e-e/3.5},{x:m+e-e/4,y:r+e/4}],A=d3.line().x(function(a){return a.x}).y(function(a){return a.y});D=a.append("path").attr("d",A(b)).style("stroke-width",y).style("stroke-linecap","round").style("fill","none").style("opacity",1).style("stroke",z?"black":"lightgrey").attr("pointer-events","none");a.on("click",function(){z=!z;D.style("stroke",z?"black":"lightgrey");g&&g();d3.event.stopPropagation()});a.append("rect").attr("width",
e).attr("height",e).attr("x",m).attr("y",r).attr("rx",q).attr("ry",l).style("fill-opacity",0).style("stroke-width",u).style("stroke","black").on("mouseover",function(){d3.select(this).transition().duration(20).style("stroke-width",u+3);d3.event.stopPropagation()}).on("mouseout",function(){d3.select(this).transition().duration(50).style("stroke-width",u);d3.event.stopPropagation()})}var e=20,m=0,r=0,q=0,l=0,y=1,u=3,z=!1,D=null,g;b.getName=function(){return a};b.size=function(a){e=a;return b};b.x=function(a){m=
a;return b};b.y=function(a){r=a;return b};b.rx=function(a){q=a;return b};b.ry=function(a){l=a;return b};b.markStrokeWidth=function(a){y=a;return b};b.boxStrokeWidth=function(a){u=a;return b};b.checked=function(a){if(void 0===a)return z;z=a;D&&D.transition().duration(100).style("stroke",D.checked?"black":"lightgrey");return b};b.mark=function(){};b.clickEvent=function(a){g=a;return b};return b};var playerDim,playerStatsGroup,LeftSideWidth=340,PlayerTableWidth=960,playerColors,theWeekChart,facts,selectedPlayerNode,showPlayerOnWeekChart,clearPlayer,soloQualifications=[],duoQualifications=[],cornerRadius=8,titleSvg,filterTextDisplayed,green="#319236",purple="#9D4DBB",blue="#4C51F7",red="#DB4441",teal="#3E93BC",lime="#3CFF3E",grey="#B3B3B3",brown="#987654",filters={week:"",region:"",search:"",player:"",sort:"payout",soloOrDuo:"",page:0,playerCount:0};
d3.json("fwc/data/data.json").then(function(a){var b=LeftSideWidth+PlayerTableWidth-20;titleSvg=title(b);searchLabel(titleSvg);posickLabel(titleSvg);disclaimer(titleSvg);a.forEach(function(a){a.rank=+a.rank;a.payout=+a.payout;a.points=+a.points});makeQualifications(a);facts=crossfilter(a);draw(facts);helpButton(titleSvg,b);filtersAndCount(titleSvg,b);d3.select("#search-input").on("keyup",function(a){filters.player="";showPlayerOnWeekChart();var b=document.getElementById("search-input").value;filters.search=
b;playerDim.filter(function(a){return-1!==a.toLowerCase().indexOf(b.toLowerCase())});dc.redrawAll()});updateCounts()});d3.csv("fwc/data/data.csv").then(function(a){});function makeQualifications(a){a.forEach(function(a){0!=a.soloQual&&soloQualifications.push({player:a.player,week:a.week.replace("Week ","")});0!=a.duoQual&&duoQualifications.push({player:a.player,week:a.week.replace("Week ","")})})}
function title(a){a=d3.select(".title").append("svg").attr("width",a+"px").attr("height","80px");a.append("text").attr("x",0).attr("y",65).text("FORTNITE  World Cup Stats").attr("font-size","1.1em").attr("fill","black");return a}function posickLabel(a){a.append("text").attr("x",565).attr("y",33).text('Support this using creator code "Posick" !').attr("font-size",".9rem").attr("fill","black").style("font-family","Helvetica, Arial, sans-serif").attr("font-weight",800)}
function searchLabel(a){a.append("text").attr("x",565).attr("y",72).text("Search").attr("font-size","1.4rem").attr("fill","black").attr("font-weight",400)}function disclaimer(a){a.append("text").attr("x",952).attr("y",30).text("Includes top 100 in each region for each week").attr("font-size",".8rem").attr("fill","#606060").style("font-family","Helvetica, Arial, sans-serif").attr("font-weight",400)}
function filtersAndCount(a,b){a.append("text").attr("x",b-540).attr("y",73).text("").attr("font-size","1.6rem").attr("fill","black").attr("pointer-events","none").attr("id","filterText1");a.append("text").attr("x",b-540).attr("y",73).text("").attr("font-size","1.6rem").attr("fill","black").attr("pointer-events","none").attr("id","filterText2")}
function helpButton(a,b){a.append("circle").attr("cx",b-30).attr("cy",46).attr("r",22).attr("fill","green").attr("stroke","black").attr("stroke-width",0).on("mouseover",function(a){d3.select(this).transition().duration(50).attr("stroke-width",4)}).on("mouseout",function(a){d3.select(this).transition().duration(50).attr("stroke-width",0)}).on("click",function(a){window.open("help.html","_blank")});a.append("text").attr("x",b-37).attr("y",59).text("?").attr("font-size",".7em").attr("fill","black").attr("pointer-events",
"none")}
function updateCounts(){makePlayerStatsGroup(playerDim);if(""!=filters.player)var a=filters.player;else{a=[];""!=filters.region&&a.push(filters.region);""!=filters.soloOrDuo?a.push(filters.soloOrDuo):""!=filters.week&&a.push(filters.week);""!=filters.search&&a.push('"'+filters.search+'"');var b=d3.format(",d");a.push(b(filters.playerCount)+" players");a=a.join(" / ");b=filters.sort.charAt(0).toUpperCase()+filters.sort.slice(1);switch(filters.sort){case "earnedQualifications":b="Earned Quals";break;
case "elims":b="Elim Points";break;case "elimPercentage":b="Elim %";break;case "placementPoints":b="Placement Points";break;case "placementPercentage":b="Placement %"}a+=" by "+b}filterTextDisplayed="#filterText1"===filterTextDisplayed?"#filterText2":"#filterText1";titleSvg.select(filterTextDisplayed).transition().duration(300).text(a).attr("fill-opacity",1);titleSvg.select("#filterText2"===filterTextDisplayed?"#filterText1":"#filterText2").transition().duration(400).attr("fill-opacity",0)}
function draw(a){playerDim=a.dimension(dc.pluck("player"));makePlayerColors();makePlayerStatsGroup(playerDim);var b=a.dimension(dc.pluck("region")),e=b.group().reduceSum(dc.pluck("payout"));a=a.dimension(dc.pluck("week"));var m=a.group().reduceSum(dc.pluck("payout"));weekChart("#chart-weeks").dimension(a).group(m);regionChart("#chart-region").dimension(b).group(e);b=playerChart("#chart-player").dimension(playerStatsGroup);dc.registerChart(b,null);dc.renderAll()}
function makePlayerColors(){playerColors={};playerDim.top(Infinity).forEach(function(a){playerColors[a.player]=getColorForRegion(a.region)})}function getColorForRegion(a){switch(a){case "NA West":return"purple";case "NA East":return"green";case "Europe":return"blue";case "Oceania":return"red";case "Asia":return"brown";case "Brazil":return"teal"}}
function makePlayerStatsGroup(){playerStatsGroup=playerDim.group().reduce(function(a,b){a.soloQual+=b.soloQual;a.duoQual+=b.duoQual;a.rank+=b.rank;a.payout+=b.payout;a.points+=b.points;a.wins+=b.wins;a.elims+=b.elims;a.elimPercentage=a.elims/a.points;a.placementPoints+=b.placementPoints;a.placementPercentage=a.placementPoints/a.points;a.earnedQualifications+=b.earnedQualifications;return a},function(a,b){a.soloQual-=b.soloQual;a.duoQual-=b.duoQual;a.rank-=b.rank;a.payout-=b.payout;a.points-=b.points;
a.wins-=b.wins;a.elims-=b.elims;a.elimPercentage=a.elims/a.points;a.placementPoints-=b.placementPoints;a.placementPercentage=a.placementPoints/a.points;a.earnedQualifications-=b.earnedQualifications;return a},function(a){return{soloQual:0,duoQual:0,rank:0,payout:0,points:0,wins:0,elims:0,elimPercentage:0,placementPoints:0,placementPercentage:0,earnedQualifications:0}})};